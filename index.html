<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>杖劍傳說 賽季 養成評分計算器</title>
    
	
<link rel="stylesheet" href="static/css/style.css">

</head>
<body>
<!-- 🌠 魔幻滑鼠星光拖尾效果 -->
<canvas id="starCanvas"></canvas>

<script>
const canvas = document.getElementById("starCanvas");
const ctx = canvas.getContext("2d");
let stars = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

document.addEventListener("mousemove", (e) => {
  for (let i = 0; i < 3; i++) {
    stars.push({
      x: e.clientX,
      y: e.clientY,
      size: Math.random() * 3 + 1,
      alpha: 1,
      color: `hsl(${Math.random() * 360}, 100%, 80%)`,
      vx: (Math.random() - 0.5) * 2,
      vy: (Math.random() - 0.5) * 2 - 1,
    });
  }
});

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  stars.forEach((s, i) => {
    s.x += s.vx;
    s.y += s.vy;
    s.alpha -= 0.02;
    if (s.alpha <= 0) stars.splice(i, 1);
    ctx.globalAlpha = s.alpha;
    ctx.fillStyle = s.color;
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
    ctx.fill();
  });
  ctx.globalAlpha = 1;
  requestAnimationFrame(animate);
}
animate();

// 讓 Canvas 蓋在最上層並點擊穿透
Object.assign(canvas.style, {
  position: "fixed",
  top: 0,
  left: 0,
  width: "100%",
  height: "100%",
  pointerEvents: "none",
  zIndex: 9999
});
</script>
	
<h1>杖劍傳說 賽季 </h1>
<h1>養成評分計算器</h1>

	  <!-- 🌍 全球造訪人數統計 -->
<div style="text-align:center; font-size:16px; color:#444;">
  👁️ <span id="visitCounter">載入中...</span>
</div>
<script>
window.addEventListener("DOMContentLoaded", () => {
  let count = localStorage.getItem("localVisits") || 0;
  count = parseInt(count) + 1;
  localStorage.setItem("localVisits", count);
  document.getElementById("visitCounter").textContent = `你的造訪次數：${count} 次`;
});
</script>




<div class="card">
<h2>原初之星</h2>
<div class="field">
<label><input type="checkbox" id="mul_s2"> S2 選項(基底45)</label>
</div>
<div class="field">
<label><input type="checkbox" id="mul_s3"> S3 選項(基底65)</label>
</div>

<button type="button" id="toggleBtn" onclick="toggleMultiplier()">
<span id="arrow" class="arrow">▼</span>
<span id="btnText">展開倍率設定</span>
</button>

<div class="card" id="multiplierCard">
<h2>倍率設定</h2>
<div class="field"><label>人物倍率</label><input type="number" id="mul_person" value="100"></div>
<div class="field"><label>裝備倍率</label><input type="number" id="mul_equip" value="18"></div>
<div class="field"><label>幻獸倍率</label><input type="number" id="mul_illusion" value="8"></div>
<div class="field"><label>技能倍率</label><input type="number" id="mul_skill" value="7"></div>
<div class="field"><label>遺物倍率</label><input type="number" id="mul_relic" value="33"></div>
<div class="field"><label>星數除數</label><input type="number" id="mul_star_div" value="27"></div>
<div class="field"><label>星數基底</label><input type="number" id="mul_star_base" value="45"></div>

<div class="btn-group">
<button type="button" onclick="saveMultiplier()">💾 儲存倍率</button>
<button type="button" onclick="resetMultiplier()">♻️ 恢復預設</button>
<button type="button" onclick="clearMultiplier()">🗑️ 清除儲存</button>
</div>
</div>
</div>

<div class="card">
<div class="field tooltip">
<label>人物等級
<span style="color:#007bff; font-weight:bold;">(倍率: <span id="personMulDisplay">100</span>)</span>
</label>
<input type="number" id="person" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span></div>
<span id="personFormula" style="color: gray; margin-left:10px;">#(人物等級 - 130) × 倍率</span>
</div>


<div class="card">
<div class="field tooltip" style="color: red;">
<label>裝備等級
<span style="color:#28a745; font-weight:bold;">(倍率: <span id="equipMulDisplay">18</span>)</span>
</label>

<input type="number" id="weapon1" value="130" min="130" max="250"><span class="tiptext">裝備5件 ~ </span>
</div>
<span id="equipFormula" style="color: gray; margin-left:10px;">#(5件總和 - 650) × 倍率</span>
<button type="button" onclick="toggleSection('equipCard','equipArrow','equipBtnText','展開裝備細項','收合裝備細項')">
  <span id="equipArrow" class="arrow">▼</span>
  <span id="equipBtnText">展開裝備細項</span>
</button>
<div id="equipCard" style="display:none; margin-top:10px;">
<div style="display:flex; gap:20px; flex-wrap: wrap;">
<div class="field tooltip"><label>武器</label><input type="number" id="weapon" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span></div>
<div class="field tooltip"><label>副手</label><input type="number" id="assistant" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span></div>
<div class="field tooltip"><label>頭盔</label><input type="number" id="headgear" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span></div>
<div class="field tooltip"><label>衣服</label><input type="number" id="clothes" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span></div>
<div class="field tooltip"><label>鞋子</label><input type="number" id="shoes" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span></div>
</div></div></div>



<div class="card">
<div class="field tooltip" style="color: red;">
<label>幻獸等級
<span style="color:#ff9800; font-weight:bold;">(倍率: <span id="illusionMulDisplay">8</span>)</span>
</label>
<input type="number" id="illusion5" value="130" min="130" max="250"><span class="tiptext">幻獸1 ~ 幻獸4</span>
</div>
<span id="illusionFormula" style="color: gray; margin-left:10px;">#(4個總和 - 520) × 倍率</span>
<button type="button" onclick="toggleSection('equipCard1','equipArrow1','equipBtnText1','展開幻獸1 ~ 4','收合幻獸1 ~ 4')">
  <span id="equipArrow1" class="arrow">▼</span>
  <span id="equipBtnText1">展開幻獸1 ~ 4</span>
</button>
<div id="equipCard1" style="display:none; margin-top:10px;">
<div style="display:flex; gap:20px; flex-wrap: wrap;">
<div class="field tooltip"><label>幻獸1</label><input type="number" id="illusion1" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span></div>
<div class="field tooltip"><label>幻獸2</label><input type="number" id="illusion2" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span></div>
<div class="field tooltip"><label>幻獸3</label><input type="number" id="illusion3" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span></div>
<div class="field tooltip"><label>幻獸4</label><input type="number" id="illusion4" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span></div>
</div></div></div>


<div class="card">
<div class="field tooltip">
<label>技能等級(8個)
<span style="color:#9c27b0; font-weight:bold;">(倍率: <span id="skillMulDisplay">7</span>)</span>
</label>
<input type="number" id="skill" value="130" min="130" max="250"><span class="tiptext">S2建議:130 ~ ,S3建議:160 ~ </span>
</div>
+
<div class="field tooltip"><label>技能額外增加等級</label><input type="number" id="skill_count" placeholder="無需填,有額外增加再填 " min="0" step="1"><span class="tiptext">額外增加等級總和</span></div>
<br></br><span id="skillFormula" style="color: gray; margin-left:10px;">#(8個總和 - 1040) × 倍率</span>
</div>


<div class="card">
<div class="field tooltip">
<label>遺物等級(20個)
<span style="color:#e91e63; font-weight:bold;">(倍率: <span id="relicMulDisplay">33</span>)</span>
</label>
<input type="number" id="relic_level" value="13" min="13" max="25"><span class="tiptext">S2建議:13 ~ ,S3建議:16 ~ </span>
</div>
+
<div class="field tooltip"><label>遺物額外增加等級</label><input type="number" id="relic_count" placeholder="無需填,有額外增加再填 " min="0" step="1"><span class="tiptext">額外增加等級總和</span></div>
<br></br><span id="relicFormula" style="color: gray; margin-left:10px;">#(20個總和 - 260) × 倍率</span>
</div>


<div class="card result">
<button onclick="calculate()">計算</button><br></br>
<button class="clear-btn" onclick="clearAll()">重新計算</button>
<div class="card">
<h2>計算結果</h2>
<label>人物評分: <span id="person_score">0</span></label>
<label>裝備評分: <span id="equip_score">0</span></label>
<label>幻獸評分: <span id="illusion_score">0</span></label>
<label>技能評分: <span id="skill_score">0</span></label>
<label>遺物評分: <span id="relic_score">0</span></label>
<label>總評分: <span id="total_score">0</span></label>
<label class="star">🌟 原初之星: <span id="star">0</span></label>
</div></div>


<!-- 星數表 -->
<div class="card">
<h2>原初之星參考表</h2>
<div style="margin-bottom: 20px;">
  <label for="s1value">請輸入 現有 原初之星：</label>
  <input type="number" id="s1value" placeholder="例如 200" style="width:100px; padding:10px; font-size:16px;" min="0" step="1">
  <br><br>
  <button onclick="highlightStar()">計算原初之星總和</button><br><br>
  <span id="totalDisplay" style="margin-left: 10px; font-weight: bold; color: #d63384;"></span>
</div>

  <div class="table-container" id="starTableContainer" style="display:none;">
    <table id="starTable">
      <tr><th>星數</th><th>效果</th></tr>
      <tr><td>48</td><td>攻擊</td></tr>
      <tr><td>56</td><td>升華3%</td></tr>
      <tr><td>64</td><td>防禦</td></tr>
      <tr><td>72</td><td>寶石5%</td></tr>
      <tr><td>80</td><td>生命</td></tr>
      <tr><td>88</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>96</td><td>速度</td></tr>
      <tr><td>104</td><td class="highlight">經驗2%</td></tr>
      <tr><td>116</td><td>攻擊</td></tr>
      <tr><td>128</td><td>升華3%</td></tr>
      <tr><td>140</td><td>防禦</td></tr>
      <tr><td>152</td><td>寶石5%</td></tr>
      <tr><td>164</td><td>生命</td></tr>
      <tr><td>176</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>188</td><td>速度</td></tr>
      <tr><td>200</td><td class="highlight">經驗2%</td></tr>
      <tr><td>215</td><td>攻擊</td></tr>
      <tr><td>230</td><td>升華3%</td></tr>
      <tr><td>245</td><td>防禦</td></tr>
      <tr><td>260</td><td>寶石5%</td></tr>
      <tr><td>275</td><td>生命</td></tr>
      <tr><td>290</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>305</td><td>速度</td></tr>
      <tr><td>320</td><td class="highlight">經驗2%</td></tr>
      <tr><td>340</td><td>攻擊</td></tr>
      <tr><td>360</td><td>升華3%</td></tr>
      <tr><td>380</td><td>防禦</td></tr>
      <tr><td>400</td><td>寶石5%</td></tr>
      <tr><td>420</td><td>生命</td></tr>
      <tr><td>440</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>460</td><td>速度</td></tr>
      <tr><td>480</td><td class="highlight">經驗2%</td></tr>
      <tr><td>505</td><td>攻擊</td></tr>
      <tr><td>530</td><td>升華3%</td></tr>
      <tr><td>555</td><td>防禦</td></tr>
      <tr><td>580</td><td>寶石5%</td></tr>
      <tr><td>605</td><td>生命</td></tr>
      <tr><td>630</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>655</td><td>速度</td></tr>
      <tr><td>680</td><td class="highlight">經驗2%</td></tr>
      <tr><td>710</td><td>攻擊</td></tr>
      <tr><td>740</td><td>升華3%</td></tr>
      <tr><td>770</td><td>防禦</td></tr>
      <tr><td>800</td><td>寶石5%</td></tr>
      <tr><td>830</td><td>生命</td></tr>
      <tr><td>860</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>890</td><td>速度</td></tr>
      <tr><td>920</td><td class="highlight">經驗2%</td></tr>
      <tr><td>955</td><td>攻擊</td></tr>
      <tr><td>990</td><td>升華3%</td></tr>
      <tr><td>1025</td><td>防禦</td></tr>
      <tr><td>1060</td><td>寶石5%</td></tr>
      <tr><td>1095</td><td>生命</td></tr>
      <tr><td>1130</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>1165</td><td>速度</td></tr>
      <tr><td>1200</td><td class="highlight">經驗2%</td></tr>
      <tr><td>1240</td><td>攻擊</td></tr>
      <tr><td>1280</td><td>升華3%</td></tr>
      <tr><td>1320</td><td>防禦</td></tr>
      <tr><td>1360</td><td>寶石5%</td></tr>
      <tr><td>1400</td><td>生命</td></tr>
      <tr><td>1440</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>1480</td><td>速度</td></tr>
      <tr><td>1520</td><td class="highlight">經驗2%</td></tr>
      <tr><td>1565</td><td>攻擊</td></tr>
      <tr><td>1610</td><td>升華3%</td></tr>
      <tr><td>1655</td><td>防禦</td></tr>
      <tr><td>1700</td><td>寶石5%</td></tr>
      <tr><td>1745</td><td>生命</td></tr>
      <tr><td>1790</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>1835</td><td>速度</td></tr>
      <tr><td>1880</td><td class="highlight">經驗2%</td></tr>
      <tr><td>1940</td><td>攻擊</td></tr>
      <tr><td>2000</td><td>升華3%</td></tr>
      <tr><td>2060</td><td>防禦</td></tr>
      <tr><td>2120</td><td>寶石5%</td></tr>
      <tr><td>2180</td><td>生命</td></tr>
      <tr><td>2240</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>2300</td><td>速度</td></tr>
      <tr><td>2360</td><td class="highlight">經驗2%</td></tr>
      <tr><td>2425</td><td>攻擊</td></tr>
      <tr><td>2490</td><td>升華3%</td></tr>
      <tr><td>2555</td><td>防禦</td></tr>
      <tr><td>2620</td><td>寶石5%</td></tr>
      <tr><td>2685</td><td>生命</td></tr>
      <tr><td>2750</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>2815</td><td>速度</td></tr>
      <tr><td>2880</td><td class="highlight">經驗2%</td></tr>
      <tr><td>2950</td><td>攻擊</td></tr>
      <tr><td>3020</td><td>升華3%</td></tr>
      <tr><td>3090</td><td>防禦</td></tr>
      <tr><td>3160</td><td>寶石5%</td></tr>
      <tr><td>3230</td><td>生命</td></tr>
      <tr><td>3300</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>3370</td><td>速度</td></tr>
      <tr><td>3440</td><td class="highlight">經驗2%</td></tr>
      <tr><td>3515</td><td>攻擊</td></tr>
      <tr><td>3590</td><td>升華3%</td></tr>
      <tr><td>3665</td><td>防禦</td></tr>
      <tr><td>3740</td><td>寶石5%</td></tr>
      <tr><td>3815</td><td>生命</td></tr>
      <tr><td>3890</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>3965</td><td>速度</td></tr>
      <tr><td>4040</td><td class="highlight">經驗2%</td></tr>
      <tr><td>4120</td><td>攻擊</td></tr>
      <tr><td>4200</td><td>升華3%</td></tr>
      <tr><td>4280</td><td>防禦</td></tr>
      <tr><td>4360</td><td>寶石5%</td></tr>
      <tr><td>4440</td><td>生命</td></tr>
      <tr><td>4520</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>4600</td><td>速度</td></tr>
      <tr><td>4680</td><td class="highlight">經驗2%</td></tr>
      <tr><td>4765</td><td>攻擊</td></tr>
      <tr><td>4850</td><td>升華3%</td></tr>
      <tr><td>4935</td><td>防禦</td></tr>
      <tr><td>5020</td><td>寶石5%</td></tr>
      <tr><td>5105</td><td>生命</td></tr>
      <tr><td>5190</td><td class="highlight">翻倍2%</td></tr>
      <tr><td>5275</td><td>速度</td></tr>
      <tr><td>5360</td><td class="highlight">經驗2%</td></tr>
		
      <!-- 其餘項目可依需要繼續補上 -->
</table>
</div>
</div>

 	<div style="max-width:500px;margin:15px auto;text-align:center;font-size:12px;color:#555;line-height:1.4;">
  運算僅供參考，以遊戲實際為準<br>
  以上不含商業用途<br>
  製作@小咕  版本: 1.01  日期: 2025-11-05<br>
		

  
		
  </span>
</footer>

<!-- 🔘 右上角快捷按鈕 -->
<div id="quickMenu" style="
  position: fixed;
  top: 12px;
  right: 12px;
  z-index: 1000;
">
  <!-- 主按鈕 -->
  <button id="toggleMenu" style="
    width: 50px; height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, #4a90e2, #357abd);
    color: white;
    font-size: 24px;
    font-weight: bold;
    border: none;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    cursor: pointer;
    transition: transform 0.3s ease;
  ">☰</button>

  <!-- 展開的選單面板 -->
  <div id="menuPanel" style="
    position: absolute;
    top: 60px;
    right: 0;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    overflow: hidden;
    display: none;
    flex-direction: column;
    min-width: 180px;
  ">
 
    <a href="https://pure08402-dev.github.io/test7/equip" style="padding: 12px 16px; display: block; text-decoration: none; color: #333;">👆 S2素材計算</a>
    <a href="https://pure08402-dev.github.io/test7/Trolley" style="padding: 12px 16px; display: block; text-decoration: none; color: #333;">🛒 小推車計算</a>
	<a href="https://pure08402-dev.github.io/test7/time_one" style="padding: 12px 16px; display: block; text-decoration: none; color: #333; border-bottom: 1px solid #eee;">⭐ 原初之星達標計算</a>
	<a href="mailto:totpure@duck.com" style="padding: 12px 16px; display: block; text-decoration: none; color: #333; border-bottom: 1px solid #eee;">📮 問題回饋</a>
  </div>
</div>


		
<script>
// =====================================================
// 基礎設定
// =====================================================
let basePersonLevel = 130;  // 人物等級基底
let baseRelicLevel = 13;    // 遺物等級基底

// 預設倍率設定
const defaultValues = { 
  basePersonLevel:130, 
  baseRelicLevel:13, 
  person:100,       // 人物倍率
  equip:18,         // 裝備倍率
  illusion:8,       // 幻獸倍率
  skill:7,          // 技能倍率
  relic:33,         // 遺物倍率
  star_div:27,      // 星數除數
  star_base:45      // 星數基底
};

// S2 與 S3 特殊模式倍率
const s2Values = {...defaultValues};
const s3Values = { 
  basePersonLevel:160, 
  baseRelicLevel:16, 
  person:100, equip:14, illusion:5, skill:6, relic:26, star_div:13, star_base:65 
};

// 對應到 HTML 中倍率輸入框
const inputs = {
  person: document.getElementById('mul_person'),
  equip: document.getElementById('mul_equip'),
  illusion: document.getElementById('mul_illusion'),
  skill: document.getElementById('mul_skill'),
  relic: document.getElementById('mul_relic'),
  star_div: document.getElementById('mul_star_div'),
  star_base: document.getElementById('mul_star_base')
};

// S2、S3 勾選框
const s2Checkbox = document.getElementById("mul_s2");
const s3Checkbox = document.getElementById("mul_s3");

// 需要同步填入等級的輸入框
const levelInputs = [
  "person","weapon1","weapon","assistant","headgear","clothes","shoes",
  "skill","illusion5","illusion1","illusion2","illusion3","illusion4"
].map(id => document.getElementById(id));

const relicLevel = document.getElementById("relic_level");

// =====================================================
// 套用倍率數值
// =====================================================
function applyValues(values){
  for(let key in values){ 
    if(inputs[key]) inputs[key].value = values[key]; 
  }
  basePersonLevel = values.basePersonLevel;
  baseRelicLevel = values.baseRelicLevel;

  // 更新倍率顯示
  document.getElementById("personMulDisplay").innerText   = values.person;
  document.getElementById("equipMulDisplay").innerText    = values.equip;
  document.getElementById("illusionMulDisplay").innerText = values.illusion;
  document.getElementById("skillMulDisplay").innerText    = values.skill;
  document.getElementById("relicMulDisplay").innerText    = values.relic;
}

// =====================================================
// 套用人物/裝備等級
// =====================================================
function applyDefaultLevel(mode){
  if(mode === "S2"){
    levelInputs.forEach(input => input.value = 130);
    relicLevel.value = 13;
  }else if(mode === "S3"){
    levelInputs.forEach(input => input.value = 160);
    relicLevel.value = 16;
  }else{
    levelInputs.forEach(input => input.value = 130);
    relicLevel.value = 13;
  }
}

// =====================================================
// 勾選 S2 / S3 選項時同步處理
// =====================================================
function onCheckboxChange(option){
  if(option === "S2"){
    if(s2Checkbox.checked){
      s3Checkbox.checked = false; // 關閉 S3
      applyValues(s2Values);
      applyDefaultLevel("S2");
    }else{
      applyValues(defaultValues);
      applyDefaultLevel("default");
    }
  }else if(option === "S3"){
    if(s3Checkbox.checked){
      s2Checkbox.checked = false; // 關閉 S2
      applyValues(s3Values);
      applyDefaultLevel("S3");
    }else{
      applyValues(defaultValues);
      applyDefaultLevel("default");
    }
  }
}

// 綁定事件
s2Checkbox.addEventListener("change", ()=>onCheckboxChange("S2"));
s3Checkbox.addEventListener("change", ()=>onCheckboxChange("S3"));

// =====================================================
// 展開 / 收合倍率設定卡片
// =====================================================
function toggleMultiplier(){
  let card = document.getElementById('multiplierCard');
  let arrow = document.getElementById('arrow');
  if(card.classList.contains('show')){
    card.classList.remove('show'); 
    arrow.classList.remove('rotate');
  }else{
    card.classList.add('show'); 
    arrow.classList.add('rotate');
  }
}

// =====================================================
// 儲存、重置、清除倍率按鈕
// =====================================================
function saveMultiplier(){ alert("倍率已儲存 (暫存功能)"); }
function resetMultiplier(){ applyValues(defaultValues); }
function clearMultiplier(){ 
  applyValues(defaultValues); 
  s2Checkbox.checked=false; 
  s3Checkbox.checked=false; 
}

// =====================================================
// 取得輸入數值（整數）
function getVal(id){ return parseInt(document.getElementById(id).value)||0; }

// =====================================================
// 核心計算函數
// =====================================================
function calculate(){
  // 人物評分
  let person_score = (getVal("person") - basePersonLevel) * getVal("mul_person");

  // 裝備評分 (5件總和)
  let equip_score = ((getVal("weapon")+getVal("assistant")+getVal("headgear")+getVal("clothes")+getVal("shoes")-(basePersonLevel*5)) * getVal("mul_equip"));

  // 幻獸評分 (4個總和)
  let illusion_score = ((getVal("illusion1")+getVal("illusion2")+getVal("illusion3")+getVal("illusion4")-(basePersonLevel*4)) * getVal("mul_illusion"));

  // 技能評分 (8個總和 + 額外增加)
  let skill_score = ((getVal("skill")-basePersonLevel)*8 + getVal("skill_count")) * getVal("mul_skill");

  // 遺物評分 (20個總和 + 額外增加)
  let relic_score = ((getVal("relic_level")-baseRelicLevel)*20 + getVal("relic_count")) * getVal("mul_relic");

  // 總評分
  let total_score = person_score + equip_score + illusion_score + skill_score + relic_score;

  // 原初之星計算
  let star = Math.floor(total_score / getVal("mul_star_div") + getVal("mul_star_base"));

  // 更新頁面顯示
  document.getElementById("person_score").innerText = person_score;
  document.getElementById("equip_score").innerText = equip_score;
  document.getElementById("illusion_score").innerText = illusion_score;
  document.getElementById("skill_score").innerText = skill_score;
  document.getElementById("relic_score").innerText = relic_score;
  document.getElementById("total_score").innerText = total_score;
  document.getElementById("star").innerText = star;
}

// =====================================================
// 清除所有輸入 / 重新計算
// =====================================================
function clearAll(){ location.reload(); }

// =====================================================
// 快速填入等級
// =====================================================
document.getElementById("weapon1").addEventListener("input", function() {
  let val = parseInt(this.value) || "";
  ["weapon","assistant","headgear","clothes","shoes"].forEach(id => {
    document.getElementById(id).value = val;
  });
});

document.getElementById("illusion5").addEventListener("input", function() {
  let val = parseInt(this.value) || "";
  ["illusion1","illusion2","illusion3","illusion4"].forEach(id => {
    document.getElementById(id).value = val;
  });
});

// =====================================================
// 展開 / 收合卡片 (裝備、幻獸)
function toggleSection(sectionId, arrowId, btnTextId, expandText, collapseText) {
  const section = document.getElementById(sectionId);
  const arrow = document.getElementById(arrowId);
  const btnText = document.getElementById(btnTextId);

  if (section.style.display === "none") {
    section.style.display = "block";
    arrow.textContent = "▲";
    btnText.textContent = collapseText;
  } else {
    section.style.display = "none";
    arrow.textContent = "▼";
    btnText.textContent = expandText;
  }
}

// =====================================================
// 原初之星總和計算與高亮
// =====================================================
function highlightStar() {
  const s1 = parseInt(document.getElementById('s1value').value) || 0;
  const star = parseInt(document.getElementById('star').innerText) || 0;
  const total = s1 + star;
  document.getElementById('totalDisplay').innerText = "總和: " + total;
  
  // 顯示星數表
  document.getElementById('starTableContainer').style.display = 'block';

  // 清除所有行背景色
  const rows = document.querySelectorAll('#starTable tr');
  rows.forEach(row => row.style.backgroundColor = "");

  // 找出不超過總和的最大星數
  let maxRow = null;
  let maxValue = -Infinity;
  for (let row of rows) {
    const td = row.cells[0];
    if (!td) continue;
    const value = parseInt(td.textContent);
    if (!isNaN(value) && value <= total && value > maxValue) {
      maxValue = value;
      maxRow = row;
    }
  }
  // 高亮該行並滾動至可見
  if (maxRow) {
    maxRow.style.backgroundColor = "#ffd1dc";
    maxRow.scrollIntoView({ behavior: "smooth", block: "center" });
  }
  console.log("S1 + 原初之星總和:", total, "標示星數:", maxValue);
}

// =====================================================
// 頁面載入時預設 S2 勾選
// =====================================================
window.addEventListener("DOMContentLoaded", () => {
  s2Checkbox.checked = true;
  onCheckboxChange("S2");
});
</script>



</body>
</html>
