<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°æ¨è»Šææ–™å¤©æ•¸è¨ˆç®—å™¨</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 15px;
    }
    .card {
      max-width: 100%;
      margin: auto;
      background: #fff;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      margin-bottom: 12px;
    }
    h2 { text-align: center; color: #333; font-size: 22px; margin-bottom: 15px; }
    label { display: block; margin: 8px 0 4px; color: #555; font-size: 14px; }
    input {
      width: 100%;
      min-width: 0;
      padding: 12px;
      margin-bottom: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
    }
    button {
      width: 100%;
      padding: 14px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      margin-top: 8px;
    }
    button:hover { background: #45a049; }
    .result {
      width: 100%;
      margin-top: 18px;
      padding: 15px;
      background: #f0f9ff;
      border: 1px solid #b6e0fe;
      border-radius: 10px;
      color: #333;
      font-size: 15px;
      line-height: 1.6;
    }
	
	 /* å¡ç‰‡æ”¶åˆå‹•ç•« */
    #multiplierCard {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease, padding 0.3s ease;
      background: #fff;
      border-radius: 12px;
      margin-top: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      padding: 0 15px;
    }
    #multiplierCard.show {
      max-height: 10000px; /* è¶³å¤ å±•é–‹ */
      padding: 15px;
    }
	
    .table-container { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; table-layout: fixed; margin-bottom: 10px; }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: center;
      word-wrap: break-word;
    }
    th { background: #f2f2f2; }
    @media (max-width: 480px) {
      h2 { font-size: 20px; }
      .result { font-size: 14px; }
      button { font-size: 16px; padding: 14px; }
      input { font-size: 16px; padding: 12px; }
    }
	
	
	.arrow {
  display: inline-block;
  transition: transform 0.3s ease;
}
.arrow.rotate {
  transform: rotate(180deg);
}


  </style>
</head>
<body>
  <h2>å°æ¨è»Šé‹ç®—ç¨‹å¼</h2>

  <!-- å¤©æ•¸è¨ˆç®— -->
  <div class="card">
    <h3 style="text-align:center;">ä¾å¤©æ•¸è¨ˆç®—å°æ¨è»Šç”¢é‡</h3>


	
	
	
	
<h3>é¸æ“‡ä¾†æº</h3>

  <label><input type="radio" name="option" value="S1" onchange="setDays();calculateResult()"> S1: æŒçºŒè‡³ 2025/08/30</label><br>
  <label><input type="radio" name="option" value="S2" onchange="setDays();calculateResult()"> S2: æŒçºŒè‡³ 2025/11/05</label><br>
  <label><input type="radio" name="option" value="manual" onchange="setDays();calculateResult()"> S3: æ‰‹å‹•è¼¸å…¥</label><br><br>

    <!-- æ¯å°æ™‚ç”¢å‡º -->
	<label for="days">è¼¸å…¥å‰©é¤˜å¤©æ•¸ï¼š</label>
    <input type="number" id="days" value="" oninput="handleDaysInput();calculateResult();calculateResult1()">

	<p id="today">ä»Šå¤©æ—¥æœŸï¼š</p>
	<p id="day_status">å‰©é¤˜å¤©æ•¸ï¼š0</p>
  
	
	  <!-- æ”¶åˆæŒ‰éˆ• -->
  <button type="button" id="toggleBtn" onclick="toggleMultiplier()">
    <span id="arrow" class="arrow">â–¼</span>
    <span id="btnText">å±•é–‹å°æ¨è»Šè¨­å®š</span>
  </button>
  
	<div class="card" id="multiplierCard">
    
      <div class="table-container">
        <table>
          <tr>
            <th>è³‡æº</th>
            <th>æ¯å°æ™‚ç”¢å‡º</th>
          </tr>
          <tr><td>é‡‘å¹£</td><td><input type="number" id="hour_gold" oninput="handleDaysInput()"></td></tr>          
          <tr><td>ç²—ç…‰çŸ³</td><td><input type="number" id="hour_stone" oninput="handleDaysInput()"></td></tr>
          <tr><td>ç²¾è¯</td><td><input type="number" id="hour_essence" oninput="handleDaysInput()"></td></tr>
		  <tr><td>ç ‚</td><td><input type="number" id="hour_sand" oninput="handleDaysInput()"></td></tr>
          <tr><td>é£¼æ–™</td><td><input type="number" id="hour_feed" oninput="handleDaysInput()"></td></tr>
        </table>
      </div>
    

  

    <!-- å°æ¨è»Šç¸½ç”¢é‡ -->
    <div class="table-container">
      <table>
        <thead>
          <tr><th>è³‡æº</th><th style="color:purple;">ç¸½ç”¢é‡</th></tr>
        </thead>
        <tbody id="day_result"></tbody>
      </table>
    </div>

    <!-- å·®é¡æ•¸é‡ -->
    <h3>å·®é¡æ•¸é‡:</h3>
    <label>
      <span style="color:green;">æœŸæœ›å€¼</span> - 
      <span style="color:purple;">ç¸½ç”¢é‡</span> - 
      <span style="color:orange;">ç›®å‰æœ‰çš„</span>
    </label>
    
    <!-- ç›®æ¨™è³‡æº -->
    <div class="card">
      <div class="table-container">
        <table>
          <tr><th>è³‡æº</th><th style="color:green;">æœŸæœ›å€¼</th></tr>
          <tr><td>é‡‘å¹£</td><td><input type="number" id="target_gold" oninput="handleDaysInput()"></td></tr>          
          <tr><td>ç²—ç…‰çŸ³</td><td><input type="number" id="target_stone" oninput="handleDaysInput()"></td></tr>
          <tr><td>ç²¾è¯</td><td><input type="number" id="target_essence" oninput="handleDaysInput()"></td></tr>
		  <tr><td>ç ‚</td><td><input type="number" id="target_sand" oninput="handleDaysInput()"></td></tr>
          <tr><td>é£¼æ–™</td><td><input type="number" id="target_feed" oninput="handleDaysInput()"></td></tr>
        </table>
      </div>
    </div>

    <!-- ç›®å‰è³‡æº -->
    <div class="card">
      <div class="table-container">
        <table>
          <tr><th>è³‡æº</th><th style="color:orange;">ç›®å‰æœ‰çš„</th></tr>
          <tr><td>é‡‘å¹£</td><td><input type="number" id="current_gold" oninput="handleDaysInput()"></td></tr>          
          <tr><td>ç²—ç…‰çŸ³</td><td><input type="number" id="current_stone" oninput="handleDaysInput()"></td></tr>
          <tr><td>ç²¾è¯</td><td><input type="number" id="current_essence" oninput="handleDaysInput()"></td></tr>
		  <tr><td>ç ‚</td><td><input type="number" id="current_sand" oninput="handleDaysInput()"></td></tr>
          <tr><td>é£¼æ–™</td><td><input type="number" id="current_feed" oninput="handleDaysInput()"></td></tr>
        </table>
      </div>
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr><th>è³‡æº</th><th>å·®é¡æ•¸é‡(<span style="color:red">è² æ•¸ä»£è¡¨æº¢å‡º</span>)</th></tr>
        </thead>
        <tbody id="day_result1"></tbody>
      </table>
    </div>

    <!-- ç§˜å¢ƒå·®é¡éœ€è¦æ¬¡æ•¸ -->
    <h3>ç§˜å¢ƒå·®é¡éœ€è¦æ¬¡æ•¸:</h3>
    <label>å·®é¡æ•¸é‡ / ç§˜å¢ƒå–®æ¬¡æŒ–å‡ºæ•¸é‡é æ¸¬</label>
    <div class="card">
      <div class="table-container">
        <table>
          <tr><th>è³‡æº</th><th>ç§˜å¢ƒå–®æ¬¡æŒ–å‡ºæ•¸é‡é æ¸¬</th></tr>
          <tr><td>é‡‘å¹£</td><td><input type="number" id="current1_gold" oninput="handleDaysInput()"></td></tr>          
          <tr><td>ç²—ç…‰çŸ³</td><td><input type="number" id="current1_stone" oninput="handleDaysInput()"></td></tr>
          <tr><td>ç²¾è¯</td><td><input type="number" id="current1_essence" oninput="handleDaysInput()"></td></tr>
		  <tr><td>ç ‚</td><td><input type="number" id="current1_sand" oninput="handleDaysInput()"></td></tr>
        </table>
      </div>
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr><th>ææ–™</th><th>ç§˜å¢ƒéœ€è¦æ¬¡æ•¸</th></tr>
        </thead>
        <tbody id="day_result2"></tbody>
      </table>
    </div>
	</div>
    
    <label for="times">è¼¸å…¥æ¯æ—¥è³¼è²·æ¬¡æ•¸ï¼š( è³¼è²·æ¬¡æ•¸ x 5 ) x å¤©æ•¸</label>
    <input type="number" id="times" value="" oninput="calculateResult()">
    <br>
    <p id="total_result">ç¸½æŒ–æ˜ï¼š</p>
  </div>

  <!-- è¨ˆç®—æŒ‰éˆ• -->
  <div style="text-align:center;">
    <button onclick="calculate()">è¨ˆç®—è³‡æºé”æˆæ™‚é–“</button>
    <button onclick="clearAll()" style="background:#f44336;">é‡æ–°è¨ˆç®—</button>
    <button onclick="saveData()" style="background:#2196F3;">ğŸ’¾ å„²å­˜æ•¸æ“š</button>
    <button onclick="resetData()" style="background:#FF9800;">â™»ï¸ æ¢å¾©é è¨­</button>
    <button onclick="window.location.href='https://pure08402-dev.github.io/test7/'">è¿”å›é¦–é </button>
  </div>

  <!-- çµæœ -->
  <div class="result" id="result">è«‹è¼¸å…¥è³‡æ–™ä¸¦æŒ‰ä¸‹è¨ˆç®—</div>

<script>
let countdownTimer; // ğŸ”¹ å…¨åŸŸè®Šæ•¸ï¼šå€’æ•¸è¨ˆæ™‚å™¨

function calculate() {
  const resources = [
    { name: "é‡‘å¹£", target: "target_gold", current: "current_gold", hour: "hour_gold" },
    { name: "ç²—ç…‰çŸ³", target: "target_stone", current: "current_stone", hour: "hour_stone" },
    { name: "ç²¾è¯", target: "target_essence", current: "current_essence", hour: "hour_essence" },
    { name: "ç ‚", target: "target_sand", current: "current_sand", hour: "hour_sand" },
    { name: "é£¼æ–™", target: "target_feed", current: "current_feed", hour: "hour_feed" }
  ];
  
  let output = "<h3>å°æ¨è»Šé”æˆæ™‚é–“</h3><div class='table-container'><table><tr><th>è³‡æº</th><th>é‚„éœ€è¦</th><th>å°æ™‚æ•¸</th><th>å¤©æ•¸</th></tr>";
  
  resources.forEach(r => {
    const target = parseInt(document.getElementById(r.target).value) || 0;
    const current = parseInt(document.getElementById(r.current).value) || 0;
    const perHour = parseInt(document.getElementById(r.hour).value) || 0;

    const need = Math.max(target - current, 0);
    const hours = perHour > 0 ? (need / perHour).toFixed(2) : "âˆ";
    const days = perHour > 0 ? (hours / 24).toFixed(2) : "âˆ";
    
    output += `<tr>
      <td>${r.name}</td>
      <td>${need.toLocaleString()}</td>
      <td>${hours}</td>
      <td>${days} å¤©</td>
    </tr>`;
  });

  output += "</table></div>";
  document.getElementById("result").innerHTML = output;
}

function clearAll() {
  document.querySelectorAll("input").forEach(input => {
    if (input.type === "radio") {
      input.checked = false;
    } else {
      input.value = "";
    }
  });
  document.getElementById("days").disabled = true;
  document.getElementById("result").innerHTML = "è«‹è¼¸å…¥è³‡æ–™ä¸¦æŒ‰ä¸‹è¨ˆç®—";
  document.getElementById("day_result").innerHTML = "";
  document.getElementById("day_result1").innerHTML = "";
  document.getElementById("day_result2").innerHTML = "";
  document.getElementById("total_result").textContent = "ç¸½æŒ–æ˜ï¼š";
  document.getElementById("day_status").textContent = "å‰©é¤˜å¤©æ•¸ï¼š0";
  clearInterval(countdownTimer);
}

const baseValues = {
  "é‡‘å¹£": "hour_gold",
  "ç²—ç…‰çŸ³": "hour_stone",
  "ç²¾è¯": "hour_essence",
  "ç ‚": "hour_sand",
  "é£¼æ–™": "hour_feed"
};

function handleDaysInput() {
  const days = parseInt(document.getElementById("days").value) || 0;
  let htmlTotal = "", htmlDiff = "", htmlTimes = "";

  function formatNumberWithWan(num) {
    const n = parseInt(num) || 0;
    const wan = (n / 10000).toFixed(2);
    return `${wan}è¬ (${n.toLocaleString()})`;
  }

  for (let item in baseValues) {
    const perHour = parseInt(document.getElementById(baseValues[item]).value) || 0;
    const current = parseInt(document.getElementById("current_" + baseValues[item].split("_")[1]).value) || 0;
    const target = parseInt(document.getElementById("target_" + baseValues[item].split("_")[1]).value) || 0;

    const total = perHour * 24 * days;
    const diff = target - total - current;
    const diffDisplay = diff < 0 ? `<span style="color:red">${formatNumberWithWan(diff)}</span>` : formatNumberWithWan(diff);

    htmlTotal += `<tr><td>${item}</td><td>${formatNumberWithWan(total)}</td></tr>`;
    htmlDiff  += `<tr><td>${item}</td><td>${diffDisplay}</td></tr>`;

    if (item !== "é£¼æ–™") {
      const dungeon = parseInt(document.getElementById("current1_" + baseValues[item].split("_")[1]).value) || 0;
      const times = dungeon > 0 ? Math.ceil(Math.max(diff, 0) / dungeon) : "âˆ";
      htmlTimes += `<tr><td>${item}</td><td>${times}</td></tr>`;
    }
  }

  document.getElementById("day_result").innerHTML = htmlTotal;
  document.getElementById("day_result1").innerHTML = htmlDiff;
  document.getElementById("day_result2").innerHTML = htmlTimes;
}

function calculateResult() {
  const days = parseInt(document.getElementById("days").value) || 0;
  const times = parseInt(document.getElementById("times").value) || 0;
  const result = days * 5 * times;
  document.getElementById("total_result").textContent = "ç¸½æŒ–æ˜ï¼š" + result + " æ¬¡";
}

// ğŸ”¹ å±•é–‹è¨­å®šå¡ç‰‡
function toggleMultiplier() {
  const card = document.getElementById("multiplierCard");
  const btnText = document.getElementById("btnText");
  const arrow = document.getElementById("arrow");
  card.classList.toggle("show");
  arrow.classList.toggle("rotate");
  btnText.textContent = card.classList.contains("show") ? "æ”¶èµ·å°æ¨è»Šè¨­å®š" : "å±•é–‹å°æ¨è»Šè¨­å®š";
}

// ğŸ”¹ å„²å­˜è³‡æ–™
function saveData() {
  let inputs = {};
  document.querySelectorAll("input").forEach(input => {
    inputs[input.id] = input.value;
  });
  localStorage.setItem("cartData", JSON.stringify(inputs));
  alert("âœ… è³‡æ–™å·²å„²å­˜ï¼");
}

// ğŸ”¹ è¼‰å…¥è³‡æ–™
function loadData() {
  const saved = localStorage.getItem("cartData");
  if (saved) {
    const inputs = JSON.parse(saved);
    Object.keys(inputs).forEach(id => {
      if (document.getElementById(id)) {
        document.getElementById(id).value = inputs[id];
      }
    });
  }
  handleDaysInput();
  calculateResult();
}

// ğŸ”¹ æ¢å¾©é è¨­
function resetData() {
  localStorage.removeItem("cartData");
  clearAll();
  alert("â™»ï¸ å·²æ¢å¾©é è¨­ï¼Œä¸¦æ¸…é™¤å„²å­˜çš„è³‡æ–™ï¼");
}

// ğŸ”¹ é¡¯ç¤ºä»Šå¤©æ—¥æœŸ
function showToday() {
  const today = new Date();
  const year = today.getFullYear();
  const month = String(today.getMonth() + 1).padStart(2, "0");
  const day = String(today.getDate()).padStart(2, "0");
  document.getElementById("today").textContent = `ä»Šå¤©æ—¥æœŸï¼š${year}/${month}/${day}`;
}

// âœ… æ”¹è‰¯ç‰ˆï¼šä»¥æ—©ä¸Š 8 é»ç‚ºåŸºæº– + å³æ™‚å€’æ•¸
function setDays() {
  const selected = document.querySelector("input[name='option']:checked").value;
  const daysInput = document.getElementById("days");
  clearInterval(countdownTimer);

  if (selected === "manual") {
    daysInput.value = "";
    daysInput.disabled = false;
    document.getElementById("day_status").innerHTML = "ç›®å‰å¤©æ•¸ï¼š0ï¼ˆæ‰‹å‹•è¼¸å…¥æ¨¡å¼ï¼‰";
  } else {
    let endDate, labelText;
    if (selected === "S1") {
      endDate = new Date("2025-08-30T08:00:00");
      labelText = "2025/08/30";
    } else if (selected === "S2") {
      endDate = new Date("2025-11-05T08:00:00");
      labelText = "2025/11/05";
    }

    const now = new Date();
    const diffTime = endDate.getTime() - now.getTime();
    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
    const daysRemaining = diffDays > 0 ? diffDays : 0;

    daysInput.value = daysRemaining;
    daysInput.disabled = true;

    document.getElementById("day_status").innerHTML = `
      å‰©é¤˜å¤©æ•¸ï¼š<strong>${daysRemaining}</strong> å¤©
      <br><span style="font-size:13px;color:#555;">ï¼ˆæˆªæ­¢è‡³ ${labelText} æ—©ä¸Š 08:00ï¼‰</span>
      <br><span id="countdown" style="color:#2b7cff;font-weight:bold;"></span>
    `;
    startCountdown(endDate);
  }
  calculateResult1();
}

// âœ… å‹•æ…‹å€’æ•¸
function startCountdown(endDate) {
  function updateCountdown() {
    const now = new Date();
    const distance = endDate - now;
    if (distance <= 0) {
      clearInterval(countdownTimer);
      document.getElementById("countdown").textContent = "â° å€’æ•¸çµæŸï¼";
      return;
    }
    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);
    document.getElementById("countdown").textContent = 
      `â³ é‚„æœ‰ ${days}å¤© ${hours}å°æ™‚ ${minutes}åˆ† ${seconds}ç§’`;
  }
  updateCountdown();
  countdownTimer = setInterval(updateCountdown, 1000);
}

function calculateResult1() {
  const days = parseInt(document.getElementById("days").value) || 0;
  if (!document.getElementById("countdown")) {
    document.getElementById("day_status").textContent = "å‰©é¤˜å¤©æ•¸ï¼š" + days;
  }
}

// é é¢è¼‰å…¥
window.onload = () => {
  showToday();
  loadData();
};
</script>

</body>
</html>
